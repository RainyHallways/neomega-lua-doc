import{_ as n,c as s,o as a,a as p}from"./app-DJ6fbNhj.js";const t={},o=p(`<h1 id="配置读取和升级相关-api" tabindex="-1"><a class="header-anchor" href="#配置读取和升级相关-api"><span>配置读取和升级相关 API</span></a></h1><h2 id="读取配置文件的配置" tabindex="-1"><a class="header-anchor" href="#读取配置文件的配置"><span>读取配置文件的配置</span></a></h2><ul><li>coromega.config <ul><li>范围：任意</li><li>说明：当执行 local coromega = require(&quot;coromega&quot;).from(omega) 时，插件对应配置文件的参数将被自动读取到 coromega.config 中<br> 您可以像访问一个通常的对象那样访问 coromega.config<br> 假设，您的配置文件看起来如下：</li></ul><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;购买.lua&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;描述&quot;</span><span class="token operator">:</span> <span class="token string">&quot;允许用户购买物品&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;是否禁用&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;来源&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LuaLoader&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;配置&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;Version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;记分板名&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coin&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;物品清单&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;苹果&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;石头&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stone&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;玻璃&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;glass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>那么您可以这样访问它们:<div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token function">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> version<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">.</span>Version</span>
<span class="line"><span class="token comment">-- 或</span></span>
<span class="line"><span class="token keyword">local</span> version<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;Version&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">local</span> scoreboard_name<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板名&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">local</span> items_list<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;物品清单&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">for</span> item_i<span class="token punctuation">,</span>item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>items_list<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;第 %s 个物品：%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>item_i<span class="token punctuation">,</span>item<span class="token punctuation">[</span><span class="token string">&quot;名称&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;- %s:%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line">    <span class="token comment">-- 或</span></span>
<span class="line">    <span class="token keyword">local</span> item_name<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;名称&quot;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">local</span> item_mc_name<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;MC名称&quot;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">local</span> item_price<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;价格&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="升级文件配置" tabindex="-1"><a class="header-anchor" href="#升级文件配置"><span>升级文件配置</span></a></h2><ul><li>update_config(new_config) <ul><li>范围：任意</li><li>说明：当您升级了您的代码后，代码可能需要一些旧配置中原本不存在的配置项<br> 此方法存在的意义就是允许您修改配置文件，使之与新代码对应<br> 例如，在上述配置文件中，您希望为配置文件添加 &quot;记分板显示名&quot; 这一选项，您可以这么做：</li></ul><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> version<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">.</span>Version</span>
<span class="line"><span class="token keyword">if</span> version<span class="token operator">==</span><span class="token string">&quot;0.0.1&quot;</span> <span class="token keyword">then</span> <span class="token comment">-- 只有当配置文件版本较旧的时候才升级</span></span>
<span class="line">    coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;金币&quot;</span></span>
<span class="line">    coromega<span class="token punctuation">.</span>config<span class="token punctuation">.</span>Version<span class="token operator">=</span><span class="token string">&quot;0.0.2&quot;</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">update_config</span><span class="token punctuation">(</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">local</span> scoreboard_display_name<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板显示名&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>当您的插件运行时，配置文件将被更新为:<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;购买.lua&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;描述&quot;</span><span class="token operator">:</span> <span class="token string">&quot;允许用户购买物品&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;是否禁用&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;来源&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LuaLoader&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;配置&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;Version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.2&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;记分板名&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coin&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;物品清单&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;苹果&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;石头&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stone&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> <span class="token property">&quot;名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;玻璃&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;MC 名称&quot;</span><span class="token operator">:</span> <span class="token string">&quot;glass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;价格&quot;</span><span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;记分板显示名&quot;</span><span class="token operator">:</span> <span class="token string">&quot;金币&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="综合使用" tabindex="-1"><a class="header-anchor" href="#综合使用"><span>综合使用</span></a></h2><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token function">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> version<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">.</span>Version</span>
<span class="line"><span class="token comment">-- 或</span></span>
<span class="line"><span class="token keyword">local</span> version<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;Version&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">local</span> scoreboard_name<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板名&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> version<span class="token operator">==</span><span class="token string">&quot;0.0.1&quot;</span> <span class="token keyword">then</span> <span class="token comment">-- 只有当配置文件版本较旧的时候才升级</span></span>
<span class="line">    coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;金币&quot;</span></span>
<span class="line">    coromega<span class="token punctuation">.</span>config<span class="token punctuation">.</span>Version<span class="token operator">=</span><span class="token string">&quot;0.0.2&quot;</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">update_config</span><span class="token punctuation">(</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">local</span> scoreboard_display_name<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;记分板显示名&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">local</span> items_list<span class="token operator">=</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">&quot;物品清单&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">for</span> item_i<span class="token punctuation">,</span>item <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>items_list<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;第 %s 个物品: %s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>item_i<span class="token punctuation">,</span>item<span class="token punctuation">[</span><span class="token string">&quot;名称&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;- %s:%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line">    <span class="token comment">-- 或</span></span>
<span class="line">    <span class="token keyword">local</span> item_name<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;名称&quot;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">local</span> item_mc_name<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;MC名称&quot;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">local</span> item_price<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token string">&quot;价格&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),e=[o];function c(l,i){return a(),s("div",null,e)}const r=n(t,[["render",c],["__file","配置读取和升级.html.vue"]]),k=JSON.parse('{"path":"/lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7%E7%9B%B8%E5%85%B3API/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7.html","title":"配置读取","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"配置读取","description":"配置读取示例"},"headers":[{"level":2,"title":"读取配置文件的配置","slug":"读取配置文件的配置","link":"#读取配置文件的配置","children":[]},{"level":2,"title":"升级文件配置","slug":"升级文件配置","link":"#升级文件配置","children":[]},{"level":2,"title":"综合使用","slug":"综合使用","link":"#综合使用","children":[]}],"git":{"updatedTime":1727773696000,"contributors":[{"name":"RainyHallways","email":"78735995+RainyHallways@users.noreply.github.com","commits":1}]},"filePathRelative":"lua插件编写/配置读取和升级相关API/配置读取和升级.md"}');export{r as comp,k as data};
