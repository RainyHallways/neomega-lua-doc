<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.classList.toggle('dark', true)
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#0055ff"><title>软API | lumega</title><meta name="description" content="软API">
    <link rel="preload" href="/./assets/style-Csv8Xx-1.css" as="style"><link rel="stylesheet" href="/./assets/style-Csv8Xx-1.css">
    <link rel="modulepreload" href="/./assets/app-DJ6fbNhj.js"><link rel="modulepreload" href="/./assets/软API.html-CC21woXP.js">
    <link rel="prefetch" href="/./assets/index.html-HlCbs4YA.js" as="script"><link rel="prefetch" href="/./assets/安装说明.html-3JMHm80_.js" as="script"><link rel="prefetch" href="/./assets/index.html-D1AO4RXB.js" as="script"><link rel="prefetch" href="/./assets/botAction.html-k4qcj67y.js" as="script"><link rel="prefetch" href="/./assets/cqhttp相关API.html-CQxVGxvQ.js" as="script"><link rel="prefetch" href="/./assets/http.html-s0eLs3Zc.js" as="script"><link rel="prefetch" href="/./assets/coromega_system.html-CwOzB3LX.js" as="script"><link rel="prefetch" href="/./assets/websocket.html-pz7I3DS2.js" as="script"><link rel="prefetch" href="/./assets/common.html-DzPA_BGt.js" as="script"><link rel="prefetch" href="/./assets/coromega_cmd.html-DoSng9rk.js" as="script"><link rel="prefetch" href="/./assets/在分发时保护你的代码.html-DQyjLSvo.js" as="script"><link rel="prefetch" href="/./assets/coromega_storage.html-D4JokYxa.js" as="script"><link rel="prefetch" href="/./assets/密码_哈希_base64.html-Dy8Y_6AU.js" as="script"><link rel="prefetch" href="/./assets/导入器_strucure_canvas相关API.html-eahcZSjY.js" as="script"><link rel="prefetch" href="/./assets/08_structure.html-CPtOgOa4.js" as="script"><link rel="prefetch" href="/./assets/60分钟闪电战.html-1Mt0hz1C.js" as="script"><link rel="prefetch" href="/./assets/数据包监听相关API.html-CT1YV-Wv.js" as="script"><link rel="prefetch" href="/./assets/coromega_place_command_block.html-0fv_-JIo.js" as="script"><link rel="prefetch" href="/./assets/coromega_botUq.html-BEM5rQTs.js" as="script"><link rel="prefetch" href="/./assets/cmd_player.html-CxwuftbD.js" as="script"><link rel="prefetch" href="/./assets/菜单相关API.html-DYE_1ZXF.js" as="script"><link rel="prefetch" href="/./assets/调试代码.html-C7zCxpPQ.js" as="script"><link rel="prefetch" href="/./assets/跨插件api调用.html-DpBUL8pq.js" as="script"><link rel="prefetch" href="/./assets/配置读取和升级.html-sj2HXpU5.js" as="script"><link rel="prefetch" href="/./assets/404.html-Bq1UP2Hx.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/./"><img class="vp-site-logo" src="/./lumega.png" alt="lumega"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">lumega</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/./%E5%AE%89%E8%A3%85%E8%AF%B4%E6%98%8E.html" aria-label="安装 NeOmega"><!---->安装 NeOmega<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/60%E5%88%86%E9%92%9F%E9%97%AA%E7%94%B5%E6%88%98.html" aria-label="编写Lua插件:快速开始"><!---->编写Lua插件:快速开始<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%B0%83%E8%AF%95lua%E4%BB%A3%E7%A0%81/%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81.html" aria-label="编写Lua插件:调试代码"><!---->编写Lua插件:调试代码<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="编写Lua插件:接口列表"><span class="title">编写Lua插件:接口列表</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="编写Lua插件:接口列表"><span class="title">编写Lua插件:接口列表</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>coromega</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7%E7%9B%B8%E5%85%B3API/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7.html" aria-label="配置读取"><!---->配置读取<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API.html" aria-label="菜单"><!---->菜单<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%91%BD%E4%BB%A4%E6%94%B6%E5%8F%91api/coromega_cmd.html" aria-label="命令"><!---->命令<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF/coromega_botUq.html" aria-label="机器人和服务器信息"><!---->机器人和服务器信息<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E7%8E%A9%E5%AE%B6%E4%BA%A4%E4%BA%92%E4%B8%8E%E5%91%BD%E4%BB%A4%E6%96%B9%E5%9D%97API/cmd_player.html" aria-label="玩家交互"><!---->玩家交互<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/botAction/botAction.html" aria-label="botAction"><!---->botAction<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%96%B9%E5%9D%97%E5%92%8C%E5%91%BD%E4%BB%A4%E5%9D%97%E6%94%BE%E7%BD%AE%E7%9B%B8%E5%85%B3/coromega_place_command_block.html" aria-label="方块、命令块"><!---->方块、命令块<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%BB%BA%E7%AD%91%E6%93%8D%E4%BD%9C/08_structure.html" aria-label="建筑操作"><!---->建筑操作<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API.html" aria-label="方块转换和 nbt"><!---->方块转换和 nbt<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API.html" aria-label="数据包"><!---->数据包<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8.html" aria-label="跨插件通信"><!---->跨插件通信<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/system/coromega_system.html" aria-label="系统功能"><!---->系统功能<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3/coromega_storage.html" aria-label="路径、存储"><!---->路径、存储<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/cqhttp%E7%9B%B8%E5%85%B3API/cqhttp%E7%9B%B8%E5%85%B3API.html" aria-label="cqhttp"><!---->cqhttp<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/http%E7%9B%B8%E5%85%B3/http.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/websocket/websocket.html" aria-label="Websocket"><!---->Websocket<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64.html" aria-label="密码、哈希和 Base64 编码"><!---->密码、哈希和 Base64 编码<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%85%B6%E4%BB%96/common.html" aria-label="其他"><!---->其他<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="在分发时保护你的代码"><!---->在分发时保护你的代码<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%BD%AFAPI/%E8%BD%AFAPI.html" aria-label="软API"><!---->软API<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/OmineDev/neomega-doc" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/./%E5%AE%89%E8%A3%85%E8%AF%B4%E6%98%8E.html" aria-label="安装 NeOmega"><!---->安装 NeOmega<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B/60%E5%88%86%E9%92%9F%E9%97%AA%E7%94%B5%E6%88%98.html" aria-label="编写Lua插件:快速开始"><!---->编写Lua插件:快速开始<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%B0%83%E8%AF%95lua%E4%BB%A3%E7%A0%81/%E8%B0%83%E8%AF%95%E4%BB%A3%E7%A0%81.html" aria-label="编写Lua插件:调试代码"><!---->编写Lua插件:调试代码<!----></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="编写Lua插件:接口列表"><span class="title">编写Lua插件:接口列表</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="编写Lua插件:接口列表"><span class="title">编写Lua插件:接口列表</span><span class="right arrow"></span></button><ul style="display:none;" class="vp-navbar-dropdown"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>coromega</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7%E7%9B%B8%E5%85%B3API/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7.html" aria-label="配置读取"><!---->配置读取<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API.html" aria-label="菜单"><!---->菜单<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%91%BD%E4%BB%A4%E6%94%B6%E5%8F%91api/coromega_cmd.html" aria-label="命令"><!---->命令<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF/coromega_botUq.html" aria-label="机器人和服务器信息"><!---->机器人和服务器信息<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E7%8E%A9%E5%AE%B6%E4%BA%A4%E4%BA%92%E4%B8%8E%E5%91%BD%E4%BB%A4%E6%96%B9%E5%9D%97API/cmd_player.html" aria-label="玩家交互"><!---->玩家交互<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/botAction/botAction.html" aria-label="botAction"><!---->botAction<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%96%B9%E5%9D%97%E5%92%8C%E5%91%BD%E4%BB%A4%E5%9D%97%E6%94%BE%E7%BD%AE%E7%9B%B8%E5%85%B3/coromega_place_command_block.html" aria-label="方块、命令块"><!---->方块、命令块<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%BB%BA%E7%AD%91%E6%93%8D%E4%BD%9C/08_structure.html" aria-label="建筑操作"><!---->建筑操作<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API.html" aria-label="方块转换和 nbt"><!---->方块转换和 nbt<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API.html" aria-label="数据包"><!---->数据包<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8.html" aria-label="跨插件通信"><!---->跨插件通信<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/system/coromega_system.html" aria-label="系统功能"><!---->系统功能<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3/coromega_storage.html" aria-label="路径、存储"><!---->路径、存储<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/cqhttp%E7%9B%B8%E5%85%B3API/cqhttp%E7%9B%B8%E5%85%B3API.html" aria-label="cqhttp"><!---->cqhttp<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/http%E7%9B%B8%E5%85%B3/http.html" aria-label="HTTP"><!---->HTTP<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/websocket/websocket.html" aria-label="Websocket"><!---->Websocket<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64.html" aria-label="密码、哈希和 Base64 编码"><!---->密码、哈希和 Base64 编码<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%85%B6%E4%BB%96/common.html" aria-label="其他"><!---->其他<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="在分发时保护你的代码"><!---->在分发时保护你的代码<!----></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%BD%AFAPI/%E8%BD%AFAPI.html" aria-label="软API"><!---->软API<!----></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/OmineDev/neomega-doc" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">编写Lua插件:接口列表 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7%E7%9B%B8%E5%85%B3API/%E9%85%8D%E7%BD%AE%E8%AF%BB%E5%8F%96%E5%92%8C%E5%8D%87%E7%BA%A7.html" aria-label="配置读取"><!---->配置读取<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API/%E8%8F%9C%E5%8D%95%E7%9B%B8%E5%85%B3API.html" aria-label="菜单"><!---->菜单<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%91%BD%E4%BB%A4%E6%94%B6%E5%8F%91api/coromega_cmd.html" aria-label="命令"><!---->命令<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF/coromega_botUq.html" aria-label="机器人和服务器信息"><!---->机器人和服务器信息<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E7%8E%A9%E5%AE%B6%E4%BA%A4%E4%BA%92%E4%B8%8E%E5%91%BD%E4%BB%A4%E6%96%B9%E5%9D%97API/cmd_player.html" aria-label="玩家交互"><!---->玩家交互<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/botAction/botAction.html" aria-label="botAction"><!---->botAction<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%96%B9%E5%9D%97%E5%92%8C%E5%91%BD%E4%BB%A4%E5%9D%97%E6%94%BE%E7%BD%AE%E7%9B%B8%E5%85%B3/coromega_place_command_block.html" aria-label="方块、命令块"><!---->方块、命令块<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%BB%BA%E7%AD%91%E6%93%8D%E4%BD%9C/08_structure.html" aria-label="建筑操作"><!---->建筑操作<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API/%E5%AF%BC%E5%85%A5%E5%99%A8_strucure_canvas%E7%9B%B8%E5%85%B3API.html" aria-label="方块转换和 nbt"><!---->方块转换和 nbt<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API/%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9B%91%E5%90%AC%E7%9B%B8%E5%85%B3API.html" aria-label="数据包"><!---->数据包<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8/%E8%B7%A8%E6%8F%92%E4%BB%B6api%E8%B0%83%E7%94%A8.html" aria-label="跨插件通信"><!---->跨插件通信<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/system/coromega_system.html" aria-label="系统功能"><!---->系统功能<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3/coromega_storage.html" aria-label="路径、存储"><!---->路径、存储<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/cqhttp%E7%9B%B8%E5%85%B3API/cqhttp%E7%9B%B8%E5%85%B3API.html" aria-label="cqhttp"><!---->cqhttp<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/http%E7%9B%B8%E5%85%B3/http.html" aria-label="HTTP"><!---->HTTP<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/websocket/websocket.html" aria-label="Websocket"><!---->Websocket<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64/%E5%AF%86%E7%A0%81_%E5%93%88%E5%B8%8C_base64.html" aria-label="密码、哈希和 Base64 编码"><!---->密码、哈希和 Base64 编码<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%85%B6%E4%BB%96/common.html" aria-label="其他"><!---->其他<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="在分发时保护你的代码"><!---->在分发时保护你的代码<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E8%BD%AFAPI/%E8%BD%AFAPI.html" aria-label="软API"><!---->软API<!----></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="软-api" tabindex="-1"><a class="header-anchor" href="#软-api"><span>软 API</span></a></h1><p>出于一些原因，例如版本控制问题，跨进程问题，api 提供者并非底层框架而是框架内组件， 一些 api 没有被包装成函数形式以便调用</p><p>而是以软 api 形式供调用</p><p>在使用它们时，你可以把它理解为类似发往服务器的 json 请求的概念</p><p>事实上，使用跨插件 api when_called_by_api_named 创建的 api 同样也是一个跨进程的软 api</p><h2 id="hasheduserid" tabindex="-1"><a class="header-anchor" href="#hasheduserid"><span>HashedUserID</span></a></h2><p>用户 Token 的哈希 (若没有 Token 此项为空，注意，可能随验证服务器密码改变而改变)</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> hashed_user_id<span class="token punctuation">,</span> found <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">soft_get</span><span class="token punctuation">(</span><span class="token string">&quot;HashedUserID&quot;</span><span class="token punctuation">)</span></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hashed_user_id&quot;</span><span class="token punctuation">,</span> hashed_user_id<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hashedservercode" tabindex="-1"><a class="header-anchor" href="#hashedservercode"><span>HashedServerCode</span></a></h2><p>用户 服务器号 的哈希</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> hashed_server_code<span class="token punctuation">,</span> found <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">soft_get</span><span class="token punctuation">(</span><span class="token string">&quot;HashedServerCode&quot;</span><span class="token punctuation">)</span></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hashed_server_code&quot;</span><span class="token punctuation">,</span> hashed_server_code<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="getnamerecord" tabindex="-1"><a class="header-anchor" href="#getnamerecord"><span>GetNameRecord</span></a></h2><p>使用一个准确的名字请求与之关联的历史或者现在的名字</p><ul><li><p>in: { &quot;current_name&quot;: string }</p></li><li><p>out: { &quot;history_names&quot;: string }</p></li></ul><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> ret<span class="token punctuation">,</span> err <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;GetNameRecord&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;current_name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;FBot_cb7826&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;ret: &quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;err: &quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="searchforname" tabindex="-1"><a class="header-anchor" href="#searchforname"><span>SearchForName</span></a></h2><p>使用一个名字或名字内的片段，例如 使用 &quot;40&quot; 搜索出 &quot;2401PT&quot;, 会搜索玩家的历史名字 (在 [改名记录] 组件中所记录的历史名字)</p><ul><li><p>in: {<br> &quot;part_of_name&quot;: string,<br> &quot;max_results&quot;: int // 最大返回数量<br> }</p></li><li><p>out: {&quot;possible_names&quot;: {<br> &quot;current&quot;: string, // 当前名<br> &quot;history&quot;: string // 历史名 (如果命中历史名)<br> } }</p></li></ul><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> ret<span class="token punctuation">,</span> err <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;SearchForName&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;part_of_name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;401P&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;max_results&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;ret: &quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- {&quot;possible_names&quot;:[{&quot;current&quot;:&quot;2401PT&quot;,&quot;history&quot;:&quot;2401PT&quot;}]}</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;err: &quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="服务" tabindex="-1"><a class="header-anchor" href="#服务"><span>服务</span></a></h2><p>服务可以通过 软API 调用</p><h3 id="为什么需要服务" tabindex="-1"><a class="header-anchor" href="#为什么需要服务"><span>为什么需要服务？</span></a></h3><p>这里需要回答3个问题:</p><ul><li>为什么不把服务对应的功能写在每个插件里？</li><li>为什么不将服务作为基础api?</li><li>为什么不将服务写成普通插件，然后通过软 api 暴露，而是必须抽取出服务这个概念？</li></ul><p>首先，请考虑这么一个场景：<br> 有两个插件，一个是计分板同步，一个是排行榜显示，他们都需要周期性发送指令获取计分板数据。</p><p>那么这两个插件都需要循环请求计分板数据吗？都需要保存计分板数据吗？<br> 当然不是，因为他俩的数据完全可以共用，只需要请求一次就可以，完全没必要把同样的事情做两次，给服务器带来双倍压力。</p><p>那么，为什么不作为框架的基础api呢？就像发送指令那样的api?<br> 如果是那样，无论是否有插件需要，omega都需要周期性发送指令请求计分板数据。<br> 然而，这与 omega 长期精心设计的api理念： 尽可能降低对服务器负担，如果不需要决不主动请求数据，相冲突。<br> 所以在不需要时，必不能对服务器产生负担，因此不能放在基础api中。</p><p>那么，为什么不作为普通插件，然后通过软 api 暴露，而是必须抽取出服务这个概念？<br> 如果这个 “前置” 插件是你自己编写的，那也不是不行。不过那样，使用的插件必须检查前置插件是否打开，这很麻烦不是吗？ 另外，抽离成服务代表调用和api更简单，可以同时服务更多的插件，用户也不必先装前置插件再装插件，使用也变得简单。</p><h3 id="启用服务" tabindex="-1"><a class="header-anchor" href="#启用服务"><span>启用服务</span></a></h3><p>启用一个服务，当启用时，终端会显示 &quot;I have control [服务名] [配置]&quot;<br> 也可以在终端输入 &quot;ctrld&quot; (即 controlled-daemon) 查看现在已启用和未启用的服务<br> 多个插件可以同时启用同一个服务，但是服务只会被启用一次，后续的启用请求不会重新启用服务，而是更改服务的配置<br> 但是，服务的配置会被如何更改则是由服务本身确定的</p><p>以下是一个启用服务的例子，对于每种服务具体参数和名称将在下文介绍</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> actual_config<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;player_eye&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        config<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;每秒请求次数&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>actual_config<span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，name 后的 &quot;player_eye&quot; 为服务名， config 后的内容为参数设置、更新<br> 返回参数为 服务实际使用的配置(例如，如果一个插件参数为4，另一个为8 其中肯定有一个参数和实际不符)和错误 每种服务的服务名和参数选项位于下文</p><h3 id="trajectory-机器人位置和轨迹" tabindex="-1"><a class="header-anchor" href="#trajectory-机器人位置和轨迹"><span>trajectory 机器人位置和轨迹</span></a></h3><p>启用服务</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">local</span> actual_config<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">      name<span class="token operator">=</span><span class="token string">&quot;trajectory&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">  coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>actual_config<span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>监听机器人位置变化事件</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">when_new_data_in_subscribed_topic_named</span><span class="token punctuation">(</span><span class="token string">&quot;brain/trajectory/pos_update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>new_pos<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>new_pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>z<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>new_pos<span class="token punctuation">.</span>dimension<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">&quot;%H:%M:%S&quot;</span><span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>unix_time<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询机器人历史位置</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">local</span> results<span class="token punctuation">,</span>err<span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/trajectory/query_pos_records&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">      max<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line">  coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;历史位置记录(最大10条)&quot;</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">for</span> i<span class="token punctuation">,</span>result <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>x<span class="token punctuation">,</span>result<span class="token punctuation">.</span>y<span class="token punctuation">,</span>result<span class="token punctuation">.</span>z<span class="token punctuation">)</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>dimension<span class="token punctuation">)</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">&quot;%H:%M:%S&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>unix_time<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例代码: 当机器人位置变化时显示新位置并查询历史位置</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> omega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;omega&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">--- @type Coromega</span></span>
<span class="line"><span class="token keyword">local</span> coromega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;coromega&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>omega<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> actual_config<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;trajectory&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>actual_config<span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">when_new_data_in_subscribed_topic_named</span><span class="token punctuation">(</span><span class="token string">&quot;brain/trajectory/pos_update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>new_pos<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>new_pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>z<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>new_pos<span class="token punctuation">.</span>dimension<span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">&quot;%H:%M:%S&quot;</span><span class="token punctuation">,</span>new_pos<span class="token punctuation">.</span>unix_time<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">local</span> results<span class="token punctuation">,</span>err<span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/trajectory/query_pos_records&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        max<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;历史位置记录(最大10条)&quot;</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i<span class="token punctuation">,</span>result <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>x<span class="token punctuation">,</span>result<span class="token punctuation">.</span>y<span class="token punctuation">,</span>result<span class="token punctuation">.</span>z<span class="token punctuation">)</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>dimension<span class="token punctuation">)</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">&quot;%H:%M:%S&quot;</span><span class="token punctuation">,</span>result<span class="token punctuation">.</span>unix_time<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="scoreboard-玩家计分板记录、查询、排行" tabindex="-1"><a class="header-anchor" href="#scoreboard-玩家计分板记录、查询、排行"><span>scoreboard 玩家计分板记录、查询、排行</span></a></h3><p>启用服务</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">local</span> actual_config<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">      name<span class="token operator">=</span><span class="token string">&quot;scoreboard&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      config<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">          <span class="token punctuation">[</span><span class="token string">&quot;每次请求周期_秒&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">  coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>actual_config<span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>计分板信息需要周期性查询，每次请求周期_秒 控制这个周期参数</p><p>监听每次查询的结果 (若无人在计分板上，则无法监听到任何数据)</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">when_new_data_in_subscribed_topic_named</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/score_update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示这次获取到的在线的所有人的所有计分板</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;scores&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>scores<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示计分板对应的显示名</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;scoreboards&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>scoreboards<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示相关玩家对应的 UUID</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;players&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>players<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 玩家 uuid 查询 玩家所有计分板分数，无论玩家是否在线</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">local</span> players <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">get_all_online_players</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">for</span> _<span class="token punctuation">,</span>player <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>player<span class="token punctuation">:</span><span class="token function">uuid_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token comment">-- 查询每个在线人的所有计分板</span></span>
<span class="line">      <span class="token comment">-- 这个 api 即使玩家不在线也可查询，只要知道 uid 即可</span></span>
<span class="line">      <span class="token keyword">local</span> player_scores<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/player_score_by_uid&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">          uid<span class="token operator">=</span>player<span class="token punctuation">:</span><span class="token function">uuid_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token comment">-- 显示查询结果</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>player<span class="token punctuation">:</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;scores:&quot;</span><span class="token punctuation">,</span>player_scores<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询计分板的数据和排行</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">local</span> rank<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/rank_by_socreboard&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;金币&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">[</span><span class="token string">&quot;降序排列&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">true</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">[</span><span class="token string">&quot;最大查询数量&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">  coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>rank<span class="token punctuation">.</span>Results<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">for</span> _<span class="token punctuation">,</span>entry <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>rank<span class="token punctuation">.</span>Results<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">      coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>PlayerName<span class="token punctuation">,</span>entry<span class="token punctuation">.</span>PlayerUID<span class="token punctuation">,</span>entry<span class="token punctuation">.</span>Score<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例代码: 每次查询计分板数据后，显示在场玩家的所有计分板和”金币“ 计分板的排行及数据</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> omega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;omega&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">--- @type Coromega</span></span>
<span class="line"><span class="token keyword">local</span> coromega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;coromega&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>omega<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> actual_config<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;scoreboard&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        config<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;每次请求周期_秒&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>actual_config<span class="token punctuation">,</span>err<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">when_new_data_in_subscribed_topic_named</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/score_update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示这次获取到的在线的所有人的所有计分板</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;scores&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>scores<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示计分板对应的显示名</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;scoreboards&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>scoreboards<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">-- 显示相关玩家对应的 UUID</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;players&quot;</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>players<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">local</span> players <span class="token operator">=</span> coromega<span class="token punctuation">:</span><span class="token function">get_all_online_players</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> _<span class="token punctuation">,</span>player <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>players<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>player<span class="token punctuation">:</span><span class="token function">uuid_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">-- 查询每个在线人的所有计分板</span></span>
<span class="line">        <span class="token comment">-- 这个 api 即使玩家不在线也可查询，只要知道 uid 即可</span></span>
<span class="line">        <span class="token keyword">local</span> player_scores<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/player_score_by_uid&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">            uid<span class="token operator">=</span>player<span class="token punctuation">:</span><span class="token function">uuid_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment">-- 显示查询结果</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>player<span class="token punctuation">:</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;scores:&quot;</span><span class="token punctuation">,</span>player_scores<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">local</span> rank<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/scoreboard/rank_by_socreboard&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;金币&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;降序排列&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">true</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;最大查询数量&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>rank<span class="token punctuation">.</span>Results<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> _<span class="token punctuation">,</span>entry <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>rank<span class="token punctuation">.</span>Results<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>PlayerName<span class="token punctuation">,</span>entry<span class="token punctuation">.</span>PlayerUID<span class="token punctuation">,</span>entry<span class="token punctuation">.</span>Score<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sidebar-侧边栏显示" tabindex="-1"><a class="header-anchor" href="#sidebar-侧边栏显示"><span>sidebar 侧边栏显示</span></a></h3><p>启用服务</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;sidebar&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_add&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;§9§l公告栏&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板轮播时间&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，计分板名只起标记作用，并不会真的创建这个计分板，它的存在只是为了后续api标记数据应该被推送到哪，以及轮播控制<br> 但是 计分板显示名 则会真的作为标题出现<br> 当多个插件都调用了这个 api，且具有不同的 计分板名 时， 这些计分板会轮流切换显示，每个计分板持续 计分板轮播时间 秒</p><p>更新显示信息</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第一组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第一行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第二行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> i<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span></span>
<span class="line">        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> </span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第二组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;负i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里，计分板名标记了数据将要被推送到哪儿，组名则将数据的更新分开。<br> 在这段代码中，我们显示了两行固定的信息和两行在不断变化的信息。<br> 我们只需将它们放在不同的组中就可以避免他们之间的信息更新相互干扰。<br> 即: 我们无需指明哪些信息需要被移除，哪些不需要，每次更新时，只有目标组的数据会被更新，其他组总是保持不变</p><p>使用示例</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> omega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;omega&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">--- @type Coromega</span></span>
<span class="line"><span class="token keyword">local</span> coromega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;coromega&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>omega<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;sidebar&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_add&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;§9§l公告栏&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板轮播时间&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第一组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第一行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第二行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> i<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span></span>
<span class="line">        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> </span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/sidebar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第二组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;负i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="listbar-暂停列表显示" tabindex="-1"><a class="header-anchor" href="#listbar-暂停列表显示"><span>listbar 暂停列表显示</span></a></h3><p>listbar 和 sidebar 的 api 几乎完全一致，效果也是，只是显示的位置由侧边栏变为暂停菜单栏 api 名中的 sidebar 改为 listbar</p><p>启用服务</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;listbar&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_add&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;§9§l公告栏&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板轮播时间&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>更新显示信息</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第一组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第一行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第二行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> i<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span></span>
<span class="line">        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> </span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第二组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;负i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里，计分板名标记了数据将要被推送到哪儿，组名则将数据的更新分开。<br> 在这段代码中，我们显示了两行固定的信息和两行在不断变化的信息。<br> 我们只需将它们放在不同的组中就可以避免他们之间的信息更新相互干扰。<br> 即: 我们无需指明哪些信息需要被移除，哪些不需要，每次更新时，只有目标组的数据会被更新，其他组总是保持不变</p><p>使用示例</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> omega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;omega&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">--- @type Coromega</span></span>
<span class="line"><span class="token keyword">local</span> coromega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;coromega&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>omega<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;listbar&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_add&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板显示名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;§9§l公告栏&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板轮播时间&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第一组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第一行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">           <span class="token punctuation">[</span><span class="token string">&quot;第二行的内容&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> i<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token keyword">true</span> <span class="token keyword">do</span></span>
<span class="line">        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span> </span>
<span class="line">        coromega<span class="token punctuation">:</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">local</span> _<span class="token punctuation">,</span>err<span class="token operator">=</span>coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/listbar/scoreboard_update&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;计分板名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;公告&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;组名&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;第二组&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;信息&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;负i为%s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="玩家视线和位置" tabindex="-1"><a class="header-anchor" href="#玩家视线和位置"><span>玩家视线和位置</span></a></h3><p>这个服务能以非常高的频率报告玩家的精细位置，玩家视线方向<br> 因此可以做出非常强大的功能，例如玩家位置记录和视线菜单</p><p>启用服务</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;player_eye&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        config<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;每秒请求次数&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里需要说明的是，每秒请求次数=4实测是安全的，完全不会增加卡顿。<br> 如果你在下面的示例中感到卡顿，那是 actionbar 导致的。</p><p>示例代码</p><div class="language-lua line-numbers-mode" data-highlighter="prismjs" data-ext="lua" data-title="lua"><pre><code><span class="line"><span class="token keyword">local</span> omega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;omega&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">local</span> json <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">--- @type Coromega</span></span>
<span class="line"><span class="token keyword">local</span> coromega <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;coromega&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>omega<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;config of xeyes:  &quot;</span><span class="token punctuation">,</span>json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>coromega<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- 如果你需要调试请将下面一段解除注释，关于调试的方法请参考文档</span></span>
<span class="line"><span class="token comment">-- local dbg = require(&#39;emmy_core&#39;)</span></span>
<span class="line"><span class="token comment">-- dbg.tcpConnect(&#39;localhost&#39;, 9966)</span></span>
<span class="line"><span class="token comment">-- print(&quot;waiting...&quot;)</span></span>
<span class="line"><span class="token comment">-- for i=1,1000 do -- 调试器需要一些时间来建立连接并交换所有信息</span></span>
<span class="line"><span class="token comment">--     -- 如果始终无法命中断点，你可以尝试将 1000 改的更大</span></span>
<span class="line"><span class="token comment">--     print(&quot;.&quot;)</span></span>
<span class="line"><span class="token comment">-- end</span></span>
<span class="line"><span class="token comment">-- print(&quot;end&quot;)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">local</span> slots_angle<span class="token operator">=</span><span class="token number">15</span></span>
<span class="line"><span class="token keyword">local</span> h_slots<span class="token operator">=</span><span class="token number">7</span></span>
<span class="line"><span class="token keyword">local</span> h_right_limit<span class="token operator">=</span><span class="token punctuation">(</span>slots_angle<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h_slots<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>slots_angle</span>
<span class="line"><span class="token keyword">local</span> h_left_limit<span class="token operator">=</span><span class="token operator">-</span>h_right_limit</span>
<span class="line"><span class="token keyword">local</span> last_y<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">local</span> last_horizental<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">local</span> xeye_on<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">call_other_plugin_api</span><span class="token punctuation">(</span><span class="token string">&quot;brain/enable&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        name<span class="token operator">=</span><span class="token string">&quot;player_eye&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        config<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token punctuation">[</span><span class="token string">&quot;每秒请求次数&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">when_called_by_game_menu</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    triggers <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;xeye&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    argument_hint <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    usage <span class="token operator">=</span> <span class="token string">&quot;启用/关闭 xeye&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>chat<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">local</span> caller_name <span class="token operator">=</span> chat<span class="token punctuation">.</span>name</span>
<span class="line">    <span class="token keyword">if</span> xeye_on<span class="token punctuation">[</span>caller_name<span class="token punctuation">]</span> <span class="token keyword">then</span> </span>
<span class="line">        xeye_on<span class="token punctuation">[</span>caller_name<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">false</span></span>
<span class="line">    <span class="token keyword">else</span> </span>
<span class="line">        xeye_on<span class="token punctuation">[</span>caller_name<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">true</span></span>
<span class="line">        last_y<span class="token punctuation">[</span>caller_name<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">nil</span> </span>
<span class="line">        last_horizental<span class="token punctuation">[</span>caller_name<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">nil</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    coromega<span class="token punctuation">:</span><span class="token function">when_new_data_in_subscribed_topic_named</span><span class="token punctuation">(</span><span class="token string">&quot;brain/player_eye/update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">start_new</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>eye_poses<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> player_name<span class="token punctuation">,</span>eye_pos <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>eye_poses<span class="token punctuation">)</span> <span class="token keyword">do</span></span>
<span class="line">            <span class="token keyword">if</span> xeye_on<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span> <span class="token keyword">then</span></span>
<span class="line">                <span class="token keyword">if</span> last_horizental<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">then</span></span>
<span class="line">                    last_horizental<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token operator">=</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;水平角度&quot;</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">if</span> last_y<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">then</span></span>
<span class="line">                    last_y<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token operator">=</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">local</span> jump<span class="token operator">=</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">]</span><span class="token operator">-</span>last_y<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span></span>
<span class="line">                <span class="token keyword">local</span> down<span class="token operator">=</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">]</span><span class="token operator">-</span>last_y<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0</span></span>
<span class="line">                last_y<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span><span class="token operator">=</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">local</span> now_h<span class="token operator">=</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;水平角度&quot;</span><span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">local</span> last_h<span class="token operator">=</span>last_horizental<span class="token punctuation">[</span>player_name<span class="token punctuation">]</span></span>
<span class="line">                <span class="token keyword">local</span> h_offset<span class="token operator">=</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>now_h<span class="token operator">-</span>last_h<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>now_h<span class="token operator">-</span><span class="token punctuation">(</span>last_h<span class="token operator">+</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>h_offset <span class="token keyword">then</span> </span>
<span class="line">                    last_h<span class="token operator">=</span>last_h<span class="token operator">+</span><span class="token number">360</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>now_h<span class="token operator">-</span><span class="token punctuation">(</span>last_h<span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>h_offset <span class="token keyword">then</span> </span>
<span class="line">                    last_h<span class="token operator">=</span>last_h<span class="token operator">-</span><span class="token number">360</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                h_offset<span class="token operator">=</span>now_h<span class="token operator">-</span>last_h</span>
<span class="line"></span>
<span class="line">                <span class="token keyword">if</span> h_offset<span class="token operator">&lt;=</span> h_left_limit <span class="token keyword">then</span> </span>
<span class="line">                    h_offset<span class="token operator">=</span>h_left_limit<span class="token operator">+</span><span class="token number">1</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">if</span> h_offset<span class="token operator">&gt;</span> h_right_limit <span class="token keyword">then</span> </span>
<span class="line">                    h_offset<span class="token operator">=</span>h_right_limit</span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">local</span> h_i<span class="token operator">=</span>math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h_offset<span class="token operator">+</span>slots_angle<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span>slots_angle<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">local</span> v_i <span class="token operator">=</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;垂直视线&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">                <span class="token keyword">local</span> m <span class="token operator">=</span><span class="token string">&quot;|&quot;</span></span>
<span class="line">                <span class="token keyword">for</span> row <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">do</span></span>
<span class="line">                    <span class="token keyword">for</span> col<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h_slots<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">(</span>h_slots<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">do</span> </span>
<span class="line">                        <span class="token keyword">if</span> row<span class="token operator">==</span><span class="token operator">-</span>v_i <span class="token keyword">and</span> col<span class="token operator">==</span>h_i <span class="token keyword">then</span></span>
<span class="line">                            m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;#&quot;</span></span>
<span class="line">                        <span class="token keyword">else</span> </span>
<span class="line">                            m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;_&quot;</span></span>
<span class="line">                        <span class="token keyword">end</span> </span>
<span class="line">                        </span>
<span class="line">                    <span class="token keyword">end</span> </span>
<span class="line">                    <span class="token keyword">if</span> row<span class="token operator">~=</span><span class="token number">2</span> <span class="token keyword">then</span></span>
<span class="line">                        m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;|\n|&quot;</span></span>
<span class="line">                    <span class="token keyword">else</span> </span>
<span class="line">                        m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;|&quot;</span></span>
<span class="line">                    <span class="token keyword">end</span></span>
<span class="line">                <span class="token keyword">end</span></span>
<span class="line">                <span class="token keyword">if</span> jump <span class="token keyword">then</span></span>
<span class="line">                    m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;\n &gt; 跳起!\n|&quot;</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                <span class="token keyword">if</span> down <span class="token keyword">then</span></span>
<span class="line">                    m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token string">&quot;\n &gt; 落下!\n|&quot;</span></span>
<span class="line">                <span class="token keyword">end</span> </span>
<span class="line">                m<span class="token operator">=</span>m<span class="token operator">..</span><span class="token punctuation">(</span><span class="token string">&quot;\n xeye\n[%s,%s,%s]\n[维度%s]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span></span>
<span class="line">                    math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">[</span><span class="token string">&quot;Z&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                    eye_pos<span class="token punctuation">[</span><span class="token string">&quot;维度&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">                coromega<span class="token punctuation">:</span><span class="token function">send_wo_cmd</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;title %s actionbar %s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">format</span><span class="token punctuation">(</span>player_name<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">end</span></span>
<span class="line">        <span class="token keyword">end</span> </span>
<span class="line">    <span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">end</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">coromega<span class="token punctuation">:</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在聊天栏输入 xeye 一个界面将在你眼前打开，<br> 界面包括了一个根据你视线方向定位的光标<br> 和详细的坐标及维度信息</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/OmineDev/neomega-doc/edit/main/lua插件编写/软API/软API.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">最近更新: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 78735995+RainyHallways@users.noreply.github.com">RainyHallways</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/./lua%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81/%E5%9C%A8%E5%88%86%E5%8F%91%E6%97%B6%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="在分发时保护你的代码"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>在分发时保护你的代码</span></div></a><!----></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/./assets/app-DJ6fbNhj.js" defer></script>
  </body>
</html>
